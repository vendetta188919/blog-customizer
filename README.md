# Проектная работа: Вёрстка проекта

Стек: React, TypeScript, SCSS Modules, Webpack, CSS-переменные

[Макет проекта](https://www.figma.com/file/FEeiiGLOsE7ktXbPpBxYoD/Custom-dropdown?type=design&node-id=0%3A1&mode=design&t=eXRJnWC6Xsuw0qR4-1)

## Описание проекта

«Вёрстка проекта» — это React-приложение для кастомизации внешнего вида статьи. Пользователи могут изменять параметры отображения статьи (шрифт, размер шрифта, цвета, ширину контента) через боковую панель настроек. Изменения применяются к статье через CSS-переменные, что позволяет динамически изменять стили без перезагрузки страницы.

## Структура проекта

- `src/` — исходные файлы проекта
- `src/components/` — папка с React-компонентами
  - `article/` — компонент статьи
  - `article-params-form/` — компонент формы настроек
- `src/ui/` — папка с переиспользуемыми UI-компонентами
  - `arrow-button/` — кнопка открытия/закрытия сайдбара
  - `button/` — кнопка действия
  - `select/` — выпадающий список
  - `radio-group/` — группа радиокнопок
  - `text/` — компонент текста
- `src/hooks/` — папка с кастомными хуками
- `src/constants/` — папка с константами и типами
- `src/styles/` — папка со стилями
- `src/fonts/` — папка с файлами шрифтов

Важные файлы:

- `src/index.tsx` — точка входа приложения
- `src/App.tsx` — главный компонент приложения
- `src/constants/articleProps.ts` — файл с константами, типами и опциями настроек
- `src/hooks/useArticleParams.ts` — кастомный хук для управления состоянием статьи
- `src/components/article-params-form/ArticleParamsForm.tsx` — компонент формы настроек
- `src/components/article/Article.tsx` — компонент статьи

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды:

```
npm install
npm start
```

или

```
yarn
yarn start
```

Проект будет доступен по адресу `http://localhost:8080`

## Сборка

```
npm run build
```

или

```
yarn build
```

## Дополнительные команды

Для запуска Storybook выполните:

```
npm run storybook
```

Для запуска линтера для стилей выполните:

```
npm run stylelint
```

Для запуска линтера выполните:

```
npm run lint
```

Для запуска форматтера выполните:

```
npm run format
```

## Архитектура приложения

Код приложения построен на основе React с использованием функциональных компонентов и хуков. Архитектура следует принципам:

- **Single Responsibility Principle (SRP)** — каждый компонент и хук отвечает за одну задачу
- **Подъем состояния (Lifting State Up)** — состояние поднято в компонент `App` через кастомный хук
- **Разделение ответственности** — логика управления состоянием вынесена в кастомный хук, компоненты отвечают только за отображение

Взаимодействие между компонентами обеспечивается через обработчики событий и пропсы. Состояние формы и примененное состояние разделены для реализации требования "настройки не применяются сразу".

### Базовые компоненты

#### Компонент App

Главный компонент приложения, отвечает за композицию компонентов и применение CSS-переменных.

**Назначение:** Координация работы всех компонентов, применение CSS-переменных к статье.

**Расположение:** `src/App.tsx`

**Используемые хуки:**

- `useArticleParams()` — кастомный хук для управления состоянием статьи

**Методы:**

- Вычисление ширины изображения: `imageWidth` определяется на основе `appliedState.contentWidth.value` (1600px для широкого режима, 948px для узкого)

**CSS-переменные:**
Применяются к элементу `<main>` на основе `appliedState`:

- `--font-family` — семейство шрифта
- `--font-size` — размер шрифта
- `--font-color` — цвет текста
- `--container-width` — ширина контента
- `--bg-color` — цвет фона
- `--image-width` — ширина изображения (вычисляется динамически)

### Данные

В приложении используются следующие типы и интерфейсы для описания структуры данных:

#### OptionType

Тип для описания опции в выпадающем списке или группе радиокнопок.

Поля:

- `title: string` — отображаемое название опции
- `value: string` — значение опции (используется для CSS-переменных)
- `className: string` — CSS-класс для стилизации
- `optionClassName?: string` — опциональный CSS-класс для опции

#### ArticleStateType

Тип состояния статьи, описывающий все настраиваемые параметры.

Поля:

- `fontFamilyOption: OptionType` — выбранный шрифт
- `fontSizeOption: OptionType` — выбранный размер шрифта
- `fontColor: OptionType` — выбранный цвет текста
- `backgroundColor: OptionType` — выбранный цвет фона
- `contentWidth: OptionType` — выбранная ширина контента

#### FontFamiliesClasses

Тип для классов шрифтов, определенный как `(typeof fontFamilyClasses)[number]`. Может принимать значения:

- `'open-sans'`
- `'ubuntu'`
- `'cormorant-garamond'`
- `'days-one'`
- `'merriweather'`

Определяется на основе константы `fontFamilyClasses`.

### Константы

#### fontFamilyOptions

Массив опций шрифтов для выбора. Содержит 5 вариантов:

- Open Sans
- Ubuntu
- Cormorant Garamond
- Days One
- Merriweather

#### fontSizeOptions

Массив опций размеров шрифта. Содержит 3 варианта:

- 18px
- 25px
- 38px

#### fontColors

Массив опций цветов текста. Содержит 9 вариантов:

- Черный (#000000)
- Белый (#FFFFFF)
- Серый (#C4C4C4)
- Розовый (#FEAFE8)
- Ярко-розовый (#FD24AF)
- Жёлтый (#FFC802)
- Зелёный (#80D994)
- Голубой (#6FC1FD)
- Фиолетовый (#5F0DEE)

#### backgroundColors

Массив опций цветов фона. Содержит те же 9 вариантов, что и `fontColors`.

#### contentWidthArr

Массив опций ширины контента. Содержит 2 варианта:

- Широкий (1394px)
- Узкий (948px)

#### Константы ширины

- `WIDE_CONTENT_WIDTH = '1394px'` — ширина контента в широком режиме
- `NARROW_CONTENT_WIDTH = '948px'` — ширина контента в узком режиме
- `WIDE_IMAGE_WIDTH = '1600px'` — ширина изображения в широком режиме

#### defaultArticleState

Объект с дефолтными значениями всех параметров статьи. Используется для инициализации состояния и сброса настроек.

### Кастомные хуки

#### Хук useArticleParams

Кастомный хук для управления состоянием статьи.

**Назначение:** Изоляция логики управления состоянием формы и примененного состояния, обеспечение принципа SRP.

**Расположение:** `src/hooks/useArticleParams.ts`

**Состояние:**

- `formState: ArticleStateType` — состояние формы (не примененное, изменяется при взаимодействии с формой)
- `appliedState: ArticleStateType` — примененное состояние (используется для CSS-переменных)

**Методы:**

- `handleFieldChange<K extends keyof ArticleStateType>(field: K, option: ArticleStateType[K])` — универсальный обработчик изменения полей формы (DRY принцип). Использует дженерики для типобезопасности.
- `handlers` — объект с обработчиками для каждого поля формы через замыкания (логически связанные данные как объект):
  - `onFontFamilyChange(option: OptionType)`
  - `onFontSizeChange(option: OptionType)`
  - `onFontColorChange(option: OptionType)`
  - `onBackgroundColorChange(option: OptionType)`
  - `onContentWidthChange(option: OptionType)`
- `handleApply()` — применяет состояние формы к примененному состоянию
- `handleReset()` — сбрасывает оба состояния в `defaultArticleState`

**Возвращаемые значения:**

- `formState` — состояние формы
- `appliedState` — примененное состояние
- `handlers` — объект с обработчиками
- `handleApply` — обработчик применения
- `handleReset` — обработчик сброса

**Преимущества:**

- Соответствует принципу Single Responsibility Principle (SRP)
- Упрощает тестирование логики отдельно от компонентов
- Можно переиспользовать в других компонентах при необходимости

### Компоненты

#### Компонент ArticleParamsForm

Компонент формы настроек статьи в боковой панели.

**Назначение:** Отображение формы с полями для настройки параметров статьи и обработка взаимодействия пользователя.

**Расположение:** `src/components/article-params-form/ArticleParamsForm.tsx`

**Пропсы (ArticleParamsFormProps):**

- `formState: ArticleStateType` — состояние формы
- `handlers` — объект с обработчиками изменения полей:
  - `onFontFamilyChange: (option: OptionType) => void`
  - `onFontSizeChange: (option: OptionType) => void`
  - `onFontColorChange: (option: OptionType) => void`
  - `onBackgroundColorChange: (option: OptionType) => void`
  - `onContentWidthChange: (option: OptionType) => void`
- `onApply: () => void` — обработчик применения настроек
- `onReset: () => void` — обработчик сброса настроек

**Внутреннее состояние:**

- `isMenuOpen: boolean` — состояние открытия/закрытия сайдбара (инкапсулировано в компоненте)

**Используемые хуки:**

- `useState<boolean>` — для управления состоянием открытия сайдбара
- `useRef<HTMLElement>` — для ссылки на элемент сайдбара (закрытие по клику вне)
- `useEffect` — для обработки клика вне сайдбара
- `useCallback` — для мемоизации обработчиков `handleSubmit` и `handleResetForm`

**Методы:**

- `handleToggle()` — переключает состояние открытия сайдбара (внутренний метод)

**Поля формы:**

- **Шрифт** — компонент `Select` с опциями шрифтов
- **Размер шрифта** — компонент `RadioGroup` с тремя размерами (18px, 25px, 38px)
- **Цвет текста** — компонент `Select` с опциями цветов
- **Цвет фона** — компонент `Select` с опциями цветов
- **Ширина контента** — компонент `Select` с опциями ширины

**Методы:**

- `handleSubmit(e: React.FormEvent)` — обработчик отправки формы (кнопка "Применить"), мемоизирован с `useCallback`
- `handleResetForm(e: React.FormEvent)` — обработчик сброса формы (кнопка "Сбросить"), мемоизирован с `useCallback`

**Функциональность:**

- Управление состоянием открытия/закрытия сайдбара (инкапсулировано в компоненте)
- Закрытие сайдбара по клику вне области через `useEffect` и `useRef`
- Сохранение состояния формы при закрытии/открытии сайдбара
- Предотвращение перезагрузки страницы при отправке формы (`e.preventDefault()`)

#### Компонент Article

Компонент статьи для отображения контента.

**Назначение:** Отображение статьи с применением CSS-переменных для стилизации.

**Расположение:** `src/components/article/Article.tsx`

**Особенности:**

- Использует компонент `Text` для отображения текста
- Стили применяются через CSS-переменные, установленные в компоненте `App`
- Содержит заголовок, описание, изображение и текст статьи

### UI-компоненты

#### Компонент ArrowButton

Кнопка для открытия/закрытия сайдбара.

**Назначение:** Визуальное отображение состояния сайдбара и обработка клика для переключения.

**Пропсы:**

- `isOpen: boolean` — состояние открытия (определяет направление стрелки)
- `onClick: () => void` — обработчик клика

#### Компонент Select

Выпадающий список для выбора опции.

**Назначение:** Отображение выбранной опции и списка доступных опций при клике.

**Пропсы:**

- `title?: string` — заголовок поля
- `selected: OptionType | null` — выбранная опция
- `options: OptionType[]` — массив доступных опций
- `placeholder?: string` — текст-заглушка
- `onChange?: (selected: OptionType) => void` — обработчик изменения
- `onClose?: () => void` — обработчик закрытия

**Функциональность:**

- Открытие/закрытие списка при клике
- Закрытие при клике вне области
- Закрытие при выборе опции
- Поддержка клавиатуры

#### Компонент RadioGroup

Группа радиокнопок для выбора одной опции из нескольких.

**Назначение:** Отображение группы опций с возможностью выбора одной.

**Пропсы:**

- `title: string` — заголовок группы
- `name: string` — имя группы (для группировки радиокнопок)
- `selected: OptionType` — выбранная опция
- `options: OptionType[]` — массив доступных опций
- `onChange?: (value: OptionType) => void` — обработчик изменения

**Функциональность:**

- Все опции отображаются одновременно
- Выбор опции изменяет состояние
- Поддержка клавиатуры (Enter для выбора)

#### Компонент Button

Кнопка действия.

**Назначение:** Отображение кнопки с различными стилями.

**Пропсы:**

- `title: string` — текст кнопки
- `htmlType?: React.ButtonHTMLAttributes<HTMLButtonElement>['type']` — тип кнопки (submit, reset, button)
- `type: 'apply' | 'clear'` — стиль кнопки (применить или сбросить)
- `onClick?: () => void` — обработчик клика

#### Компонент Text

Компонент для отображения текста с различными стилями.

**Назначение:** Универсальный компонент текста с поддержкой различных параметров стилизации.

**Пропсы:**

- `as?: ElementType` — HTML-тег для рендеринга (по умолчанию `'div'`)
- `size?: 12 | 18 | 22 | 25 | 31 | 38 | 45` — размер шрифта (по умолчанию `18`)
- `weight?: 400 | 800` — толщина шрифта (по умолчанию `400`)
- `uppercase?: boolean` — преобразование в верхний регистр (по умолчанию `false`)
- `align?: 'center' | 'left'` — выравнивание текста (по умолчанию `'left'`)
- `fontStyle?: 'italic' | 'normal'` — стиль шрифта (по умолчанию `'normal'`)
- `dynamic?: boolean` — использование динамических CSS-переменных для цвета, размера и семейства шрифта (по умолчанию `false`)
- `dynamicLite?: boolean` — использование упрощенных динамических CSS-переменных (только цвет и семейство шрифта, по умолчанию `false`)
- `family?: FontFamiliesClasses` — семейство шрифта (по умолчанию `'open-sans'`)
